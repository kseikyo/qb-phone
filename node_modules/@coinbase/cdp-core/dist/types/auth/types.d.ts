import { KeyPair } from '../shared/types.js';
import { OAuthFlowState, OnAuthStateChangeFn, OnOAuthStateChangeFn, User } from '../types.js';
export interface AuthState {
    accessToken: string;
    expiresAt: number;
    user: User;
}
export interface WalletSecret {
    walletSecretId: string;
    keyPair: KeyPair;
    expiresAt: number;
}
export interface IOAuthManager {
    getOAuthFlowState(): Promise<OAuthFlowState | null>;
    setOAuthFlowState(oauthFlowState: OAuthFlowState): Promise<void>;
    addOAuthStateChangeCallback(callback: OnOAuthStateChangeFn): Promise<void>;
    clearOAuthFlowState(): Promise<void>;
    handleOAuthCode(url?: string): Promise<void>;
}
export interface IAuthManager {
    getUser(): User | null;
    isSignedIn(): Promise<boolean>;
    signOut(): Promise<void>;
    addAuthStateChangeCallback(callback: OnAuthStateChangeFn): void;
    getToken(): Promise<string | null>;
    getTokenExpiration(): Promise<number | null>;
    getWalletSecretId(): Promise<string>;
    getXWalletAuth(options: {
        requestMethod: string;
        requestHost: string;
        requestPath: string;
        requestData?: Record<string, unknown>;
    }): Promise<string>;
    getAuthState(): AuthState | null;
    setAuthState(authState: AuthState): Promise<void>;
    clearAuthState(): Promise<void>;
    ensureInitialized(): Promise<void>;
}
