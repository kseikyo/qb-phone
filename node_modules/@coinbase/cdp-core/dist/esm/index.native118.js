import { hexToString as s, hashMessage as i, bytesToString as a } from "viem";
import { signEvmMessage as g } from "./index.native7.js";
import { validateUserOwnsAddress as c, EIP1193ProviderError as d, STANDARD_ERROR_CODES as f } from "./index.native26.js";
async function p(r) {
  const [n, t] = r;
  await c(t);
  const o = u(n);
  try {
    const { signature: e } = await g({
      evmAccount: t,
      message: o
    });
    return e;
  } catch (e) {
    throw new d(
      f.provider.userRejectedRequest,
      e instanceof Error ? e.message : "Signing failed"
    );
  }
}
function u(r) {
  return typeof r == "string" ? s(r) : typeof r.raw == "string" ? r.raw : i(a(r.raw));
}
export {
  p as handlePersonalSign
};
