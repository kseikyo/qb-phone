import { JOSENotSupported as f } from "./index.native58.js";
const w = (n, r, a, e, s) => {
  if (s.crit !== void 0 && e?.crit === void 0)
    throw new n('"crit" (Critical) Header Parameter MUST be integrity protected');
  if (!e || e.crit === void 0)
    return /* @__PURE__ */ new Set();
  if (!Array.isArray(e.crit) || e.crit.length === 0 || e.crit.some((i) => typeof i != "string" || i.length === 0))
    throw new n('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');
  let t;
  a !== void 0 ? t = new Map([...Object.entries(a), ...r.entries()]) : t = r;
  for (const i of e.crit) {
    if (!t.has(i))
      throw new f(`Extension Header Parameter "${i}" is not recognized`);
    if (s[i] === void 0)
      throw new n(`Extension Header Parameter "${i}" is missing`);
    if (t.get(i) && e[i] === void 0)
      throw new n(`Extension Header Parameter "${i}" MUST be integrity protected`);
  }
  return new Set(e.crit);
};
export {
  w as default
};
